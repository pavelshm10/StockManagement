{"version":3,"sources":["../../../../../packages/vite/src/utils/e2e-web-server-info-utils.ts"],"sourcesContent":["import { type Tree, readNxJson } from '@nx/devkit';\nimport { getE2EWebServerInfo } from '@nx/devkit/src/generators/e2e-web-server-info-utils';\n\nexport async function getViteE2EWebServerInfo(\n  tree: Tree,\n  projectName: string,\n  configFilePath: string,\n  isPluginBeingAdded: boolean,\n  e2ePortOverride?: number,\n  e2eCIPortOverride?: number\n) {\n  const nxJson = readNxJson(tree);\n  let e2ePort = e2ePortOverride ?? 4200;\n\n  if (\n    (nxJson.targetDefaults?.['dev'] &&\n      nxJson.targetDefaults?.['dev'].options?.port) ||\n    (nxJson.targetDefaults?.['serve'] &&\n      nxJson.targetDefaults?.['serve'].options?.port)\n  ) {\n    e2ePort =\n      nxJson.targetDefaults?.['dev'].options?.port ??\n      nxJson.targetDefaults?.['serve'].options?.port;\n  }\n\n  return getE2EWebServerInfo(\n    tree,\n    projectName,\n    {\n      plugin: '@nx/vite/plugin',\n      serveTargetName: 'devTargetName',\n      serveStaticTargetName: 'previewTargetName',\n      configFilePath,\n    },\n    {\n      defaultServeTargetName: 'dev',\n      defaultServeStaticTargetName: 'preview',\n      defaultE2EWebServerAddress: `http://localhost:${e2ePort}`,\n      defaultE2ECiBaseUrl: `http://localhost:${e2eCIPortOverride ?? 4300}`,\n      defaultE2EPort: e2ePort,\n    },\n    isPluginBeingAdded\n  );\n}\n\nexport async function getReactRouterE2EWebServerInfo(\n  tree: Tree,\n  projectName: string,\n  configFilePath: string,\n  isPluginBeingAdded: boolean,\n  e2ePortOverride?: number,\n  e2eCIPortOverride?: number\n) {\n  const e2ePort = e2ePortOverride ?? parseInt(process.env.PORT) ?? 4200;\n\n  return await getE2EWebServerInfo(\n    tree,\n    projectName,\n    {\n      plugin: '@nx/react/router-plugin',\n      serveTargetName: 'devTargetName',\n      serveStaticTargetName: 'devTargetName',\n      configFilePath,\n    },\n    {\n      defaultServeTargetName: 'dev',\n      defaultServeStaticTargetName: 'dev',\n      defaultE2EWebServerAddress: `http://localhost:${e2ePort}`,\n      defaultE2ECiBaseUrl: `http://localhost:${e2eCIPortOverride ?? 4200}`,\n      defaultE2EPort: e2ePort,\n    },\n    isPluginBeingAdded\n  );\n}\n"],"names":["getReactRouterE2EWebServerInfo","getViteE2EWebServerInfo","tree","projectName","configFilePath","isPluginBeingAdded","e2ePortOverride","e2eCIPortOverride","nxJson","readNxJson","e2ePort","targetDefaults","options","port","getE2EWebServerInfo","plugin","serveTargetName","serveStaticTargetName","defaultServeTargetName","defaultServeStaticTargetName","defaultE2EWebServerAddress","defaultE2ECiBaseUrl","defaultE2EPort","parseInt","process","env","PORT"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;IA6CsBA,8BAA8B;eAA9BA;;IA1CAC,uBAAuB;eAAvBA;;;wBAHgB;uCACF;AAE7B,eAAeA,wBACpBC,IAAU,EACVC,WAAmB,EACnBC,cAAsB,EACtBC,kBAA2B,EAC3BC,eAAwB,EACxBC,iBAA0B;QAMvBC,wBACCA,oCAAAA,yBACDA,yBACCA,sCAAAA;IAPJ,MAAMA,SAASC,IAAAA,kBAAU,EAACP;IAC1B,IAAIQ,UAAUJ,0BAAAA,kBAAmB;IAEjC,IACE,EAACE,yBAAAA,OAAOG,cAAc,qBAArBH,sBAAuB,CAAC,MAAM,OAC7BA,0BAAAA,OAAOG,cAAc,sBAArBH,qCAAAA,uBAAuB,CAAC,MAAM,CAACI,OAAO,qBAAtCJ,mCAAwCK,IAAI,KAC7CL,EAAAA,0BAAAA,OAAOG,cAAc,qBAArBH,uBAAuB,CAAC,QAAQ,OAC/BA,0BAAAA,OAAOG,cAAc,sBAArBH,uCAAAA,uBAAuB,CAAC,QAAQ,CAACI,OAAO,qBAAxCJ,qCAA0CK,IAAI,GAChD;YAEEL,qCAAAA,yBACAA,uCAAAA;YADAA;QADFE,UACEF,CAAAA,2CAAAA,0BAAAA,OAAOG,cAAc,sBAArBH,sCAAAA,uBAAuB,CAAC,MAAM,CAACI,OAAO,qBAAtCJ,oCAAwCK,IAAI,YAA5CL,2CACAA,0BAAAA,OAAOG,cAAc,sBAArBH,wCAAAA,uBAAuB,CAAC,QAAQ,CAACI,OAAO,qBAAxCJ,sCAA0CK,IAAI;IAClD;IAEA,OAAOC,IAAAA,0CAAmB,EACxBZ,MACAC,aACA;QACEY,QAAQ;QACRC,iBAAiB;QACjBC,uBAAuB;QACvBb;IACF,GACA;QACEc,wBAAwB;QACxBC,8BAA8B;QAC9BC,4BAA4B,CAAC,iBAAiB,EAAEV,QAAQ,CAAC;QACzDW,qBAAqB,CAAC,iBAAiB,EAAEd,4BAAAA,oBAAqB,KAAK,CAAC;QACpEe,gBAAgBZ;IAClB,GACAL;AAEJ;AAEO,eAAeL,+BACpBE,IAAU,EACVC,WAAmB,EACnBC,cAAsB,EACtBC,kBAA2B,EAC3BC,eAAwB,EACxBC,iBAA0B;QAEVD;IAAhB,MAAMI,UAAUJ,CAAAA,OAAAA,0BAAAA,kBAAmBiB,SAASC,QAAQC,GAAG,CAACC,IAAI,aAA5CpB,OAAiD;IAEjE,OAAO,MAAMQ,IAAAA,0CAAmB,EAC9BZ,MACAC,aACA;QACEY,QAAQ;QACRC,iBAAiB;QACjBC,uBAAuB;QACvBb;IACF,GACA;QACEc,wBAAwB;QACxBC,8BAA8B;QAC9BC,4BAA4B,CAAC,iBAAiB,EAAEV,QAAQ,CAAC;QACzDW,qBAAqB,CAAC,iBAAiB,EAAEd,4BAAAA,oBAAqB,KAAK,CAAC;QACpEe,gBAAgBZ;IAClB,GACAL;AAEJ"}